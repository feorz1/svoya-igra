<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°–≤–æ—è –ò–≥—Ä–∞</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Condensed:wght@700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
</head>
<body>

    <aside id="sidebar" class="sidebar">
        <div class="sidebar-header">
            <h2>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
            <button class="icon-btn" onclick="toggleSidebar()">
                <span class="material-icons-round">close</span>
            </button>
        </div>
        
        <div class="sidebar-section">
            <h3>üìÇ –§–∞–π–ª –≤–æ–ø—Ä–æ—Å–æ–≤</h3>
            <div class="sidebar-buttons-container">
                <label class="btn btn-primary full-width">
                    –ó–ê–ì–†–£–ó–ò–¢–¨ .TXT
                    <input type="file" id="file-input" accept=".txt" hidden onchange="handleFileUpload(this)">
                </label>
                <button class="btn btn-secondary full-width" onclick="downloadGameData()">
                    –°–ö–ê–ß–ê–¢–¨ –ü–†–û–ì–†–ï–°–°
                </button>
            </div>
            <p style="font-size: 0.8rem; color: #888; margin-top: 10px; line-height: 1.4;">
                –ê–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∞ –∏–∑ questions.txt –≤–∫–ª—é—á–µ–Ω–∞.
            </p>
        </div>

        <div class="sidebar-content" id="editor-content"></div>
        <div class="sidebar-footer">
            <button class="btn btn-primary full-width" onclick="saveAndRefresh()">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
            <button class="btn btn-danger full-width" style="margin-top:10px" onclick="resetToDefault()">–°–±—Ä–æ—Å</button>
        </div>
    </aside>

    <main class="main-container">
        <header class="top-bar">
            <div class="left-section">
                <button class="icon-btn menu-btn" onclick="toggleSidebar()">
                    <span class="material-icons-round">menu</span>
                </button>
                <h1>–°–≤–æ—è –ò–≥—Ä–∞</h1>
                <button class="icon-btn" onclick="playSound('intro')" title="–ó–∞—Å—Ç–∞–≤–∫–∞" style="margin-left: 10px;">
                    <span class="material-icons-round">play_circle</span>
                </button>
            </div>
            
            <div id="round-tabs" class="round-tabs">
                <button class="round-tab active">–†–∞—É–Ω–¥ 1</button>
            </div>
            
            <div style="display: flex; gap: 10px;">
                <button class="btn btn-success btn-sm" onclick="showStats()">üìä –ò–¢–û–ì–ò</button>
            </div>
        </header>

        <div class="content-row">
            <div class="game-area">
                <div id="game-board" class="board-grid"></div>
            </div>

            <div class="players-section">
                <div id="players-list" class="players-list"></div>
                <div class="players-controls">
                    <button class="btn btn-small btn-add" onclick="addPlayer()">
                        <span class="material-icons-round">add</span>
                    </button>
                </div>
            </div>
        </div>
    </main>

    <div id="modal" class="modal-overlay hidden">
        <div class="modal-card">
            <div class="modal-header-line">
                <span id="modal-category">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</span><span style="margin-right: 5px;">,</span>
                <span id="modal-points">100</span>
            </div>
            
            <div class="modal-body">
                <div id="question-text" class="text-display">–¢–µ–∫—Å—Ç –≤–æ–ø—Ä–æ—Å–∞</div>
                <div id="answer-container" class="answer-container hidden">
                    <div class="answer-label">–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç:</div>
                    <div id="answer-text" class="answer-card">–û—Ç–≤–µ—Ç</div>
                </div>
            </div>

            <div class="modal-footer">
                <div id="decision-controls" class="player-controls">
                    <div class="current-turn-label">
                        –•–æ–¥: <span id="modal-player-name-decision" class="highlight-name">...</span>
                    </div>
                    <div class="action-buttons">
                        <button class="btn btn-primary btn-lg" onclick="revealAnswer()">–û—Ç–≤–µ—Ç–∏—Ç—å</button>
                        <button class="btn btn-secondary btn-lg" onclick="handlePass()">–ü–∞—Å ‚ûú</button>
                    </div>
                </div>

                <div id="scoring-controls" class="player-controls hidden">
                    <div class="current-turn-label">
                        –ü—Ä–æ–≤–µ—Ä–∫–∞: <span id="modal-player-name-scoring" class="highlight-name">...</span>
                    </div>
                    <div class="action-buttons">
                        <button class="btn btn-success" onclick="handleScore(true)">–í–µ—Ä–Ω–æ (+)</button>
                        <button class="btn btn-danger" onclick="handleScore(false)">–ù–µ–≤–µ—Ä–Ω–æ (-)</button>
                    </div>
                </div>
                
                <div id="close-modal-btn" class="hidden" style="margin-top: 20px;">
                     <button class="btn btn-outline" onclick="closeModal()">–ó–∞–∫—Ä—ã—Ç—å –≤–æ–ø—Ä–æ—Å</button>
                </div>
            </div>
        </div>
    </div>

    <div id="stats-modal" class="modal-overlay hidden" style="z-index: 2000;">
        <div class="stats-card">
            <div class="stats-header">
                <h2>–ò–¢–û–ì–û–í–´–ô –°–ß–ï–¢</h2>
                <button class="icon-btn" onclick="closeStats()">
                    <span class="material-icons-round" style="font-size: 2rem;">close</span>
                </button>
            </div>
            <div class="stats-body">
                <table class="stats-table">
                    <thead>
                        <tr>
                            <th>‚Ññ</th>
                            <th>–ò–≥—Ä–æ–∫</th>
                            <th>–°—á—ë—Ç</th>
                            <th>–ó–∞—Ä–∞–±–æ—Ç–∞–Ω–æ</th>
                            <th>–ü–æ—Ç–µ—Ä—è–Ω–æ</th>
                            <th>–í–µ—Ä–Ω–æ</th>
                            <th>–û—à–∏–±–∫–∏</th>
                        </tr>
                    </thead>
                    <tbody id="stats-table-body">
                        </tbody>
                </table>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
